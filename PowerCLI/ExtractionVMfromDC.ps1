
###################################
### Extraction d'une vue des VM ###
###################################
# Nom de la Vm                    #
# Nb CPU                          #
# OS                              #
# Les IPs/MACs                    #
# RAM                             #
# Volume(s) et FreeSpace/Total    #
###################################

$resultatPath = "C:\temp\resultat.csv"
$resultat = Get-Datacenter "NomDC" | Get-VM | select Name, NumCPU, Guest, MemoryGB,
 @{Name=’IP Address‘;Expression={[string]::join(“;”, ($_.guest.IPAddress))}},
 @{Name=’Volume(s)‘;Expression={((get-vm $_).extensiondata.Guest.Disk | sort $_.Diskpath | %{" $($_.diskPath) , $([math]::Round($_.FreeSpace /1024MB,2)) GB , $([math]::Round($_.Capacity /1024MB,2)) GB"}) -join ','}}
 
$resultat |Export-CSV -Path $resultatPath -Force –NoTypeInformation
