# Récupérer tous les groupes qui commencent par "groupeA"
$groups = Get-ADGroup -Filter {Name -like "groupeA*"}

# Pour chaque groupe, récupérer les membres du groupe
$groups | ForEach-Object {
  $group = $_
  $members = Get-ADGroupMember -Identity $group
  if($members -eq $null){ #Cas groupe vide
    New-Object -TypeName PSobject -Property @{
            group = $group.Name
            membre = ""
            sam = ""
    }
  }
  else{ #Une ligne pour chaque membre
      $members | ForEach-Object { 
        $member = $_
        New-Object -TypeName PSobject -Property @{
            group = $group.Name
            membre = $member.name
            sam = $member.SamAccountName
        }
      }
  }
} | Export-Csv -Path "C:\temp\MemberGrp.csv" -NoTypeInformation
