<#
    Copie les membres d'un groupe sources vers un groupe destination et les retire du groupe source.

    usage .\moveADGroupMembers.ps1 -from <nom groupe sources> -to <nom groupe dest>

    Limite à 5000 membres
#>
Param(
    [parameter(mandatory=$true)][string]$from,
    [parameter(mandatory=$true)][string]$to
)

if((![bool] (Get-ADGroup -filter {name -eq $from})) -or (![bool] (Get-ADGroup -filter {name -eq $to}))){
    Write-Output "nom(s) de groupe(s) non existant.";
    exit
}

Get-ADGroupMember -Identity $from | ForEach-Object {Add-ADGroupMember -Identity $to -Members $_.distinguishedName -and Remove-ADGroupMember -identity $from -member $_.distinguishedName}